<!doctype html><html lang=en><head><title>Compiling Latest FireFly (mt-daapd) for ASUS WL-500W :: Shantanu Vs The World</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="FireFly is a nice DAAP based media server that allows you to listen to your music collection anywhere using any DAAP based client like iTunes, with other players (like Winamp, Rhythmbox, VLC, etc) using plugins, or it even has its own dedicated php/flash/java based clients that can be fired up on any platform any computer giving you instant nirvana.
Many people, like me, use it on their Routers or NAS boxes to access their music anywhere without having to keep their home PC running or lugging around external drives."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://shantanugoel.com/2009/07/03/compiling-latest-firefly-mt-daapd-asus-wl-500w/><link rel=stylesheet href=https://shantanugoel.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css><link rel=stylesheet href=https://shantanugoel.com/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css><link rel=stylesheet href=https://shantanugoel.com/css/fonts.min.90c955c31dd7c0e05aae3d4f583d4d8a2af799d69c961337eaf2a825063a55dd.css><link rel=stylesheet href=https://shantanugoel.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css><link rel=stylesheet href=https://shantanugoel.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://shantanugoel.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css><link rel=stylesheet href=https://shantanugoel.com/css/main.min.1d8be2dd1b5de9fdaed058c8c59fcf4485f36619574abfb47ed0cfda4812c16d.css><link rel=stylesheet href=https://shantanugoel.com/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css><link rel=stylesheet href=https://shantanugoel.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css><link rel=stylesheet href=https://shantanugoel.com/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css><link rel=stylesheet href=https://shantanugoel.com/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css><link rel=stylesheet href=https://shantanugoel.com/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css><link rel=stylesheet href=https://shantanugoel.com/css/terminal.min.27a3af30c33c5e1d42bf51e61792cf1bd9390c0e57db917179413a769329355c.css><link rel=stylesheet href=https://shantanugoel.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel="shortcut icon" href=https://shantanugoel.com/favicon.png><link rel=apple-touch-icon href=https://shantanugoel.com/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Compiling Latest FireFly (mt-daapd) for ASUS WL-500W"><meta property="og:description" content="FireFly is a nice DAAP based media server that allows you to listen to your music collection anywhere using any DAAP based client like iTunes, with other players (like Winamp, Rhythmbox, VLC, etc) using plugins, or it even has its own dedicated php/flash/java based clients that can be fired up on any platform any computer giving you instant nirvana.
Many people, like me, use it on their Routers or NAS boxes to access their music anywhere without having to keep their home PC running or lugging around external drives."><meta property="og:url" content="https://shantanugoel.com/2009/07/03/compiling-latest-firefly-mt-daapd-asus-wl-500w/"><meta property="og:site_name" content="Shantanu Vs The World"><meta property="og:image" content="https://shantanugoel.com/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Code"><meta property="article:published_time" content="2009-07-03 10:28:32 +0000 UTC"></head><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Shantanu vs The World</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;‚ñæ</li><li><ul class=menu__dropdown><li><a href=https://x.com/shantanugoel/>üê§</a></li><li><a href=/>/blog</a></li><li><a href=/notes>/notes</a></li><li><a href=/about>/about</a></li><li><a href=/archives>/archives</a></li><li><a href=/categories>/categories</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=https://x.com/shantanugoel/>üê§</a></li><li><a href=/>/blog</a></li><li><a href=/notes>/notes</a></li><li><a href=/about>/about</a></li><li><a href=/archives>/archives</a></li><li><a href=/categories>/categories</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://shantanugoel.com/2009/07/03/compiling-latest-firefly-mt-daapd-asus-wl-500w/>Compiling Latest FireFly (mt-daapd) for ASUS WL-500W</a></h1><div class=post-meta><time class=post-date>2009-07-03</time><span class=post-author>Shantanu Goel</span></div><span class=post-tags>#<a href=https://shantanugoel.com/tags/asus-wl-500g/>Asus WL-500g</a>&nbsp;
#<a href=https://shantanugoel.com/tags/asus-wl-500w/>Asus WL-500W</a>&nbsp;
#<a href=https://shantanugoel.com/tags/buildroot/>buildroot</a>&nbsp;
#<a href=https://shantanugoel.com/tags/daap/>daap</a>&nbsp;
#<a href=https://shantanugoel.com/tags/firefly/>firefly</a>&nbsp;
#<a href=https://shantanugoel.com/tags/ipkg/>ipkg</a>&nbsp;
#<a href=https://shantanugoel.com/tags/itunes-daap-media-server/>itunes daap media server</a>&nbsp;
#<a href=https://shantanugoel.com/tags/media-server/>media server</a>&nbsp;
#<a href=https://shantanugoel.com/tags/mt-daapd/>mt-daapd</a>&nbsp;
#<a href=https://shantanugoel.com/tags/nas/>NAS</a>&nbsp;
#<a href=https://shantanugoel.com/tags/optware-devel/>optware-devel</a>&nbsp;
#<a href=https://shantanugoel.com/tags/patches/>patches</a>&nbsp;
#<a href=https://shantanugoel.com/tags/rhythmbox/>RhythmBox</a>&nbsp;
#<a href=https://shantanugoel.com/tags/router/>router</a>&nbsp;
#<a href=https://shantanugoel.com/tags/routers/>routers</a>&nbsp;
#<a href=https://shantanugoel.com/tags/subversion/>subversion</a>&nbsp;
#<a href=https://shantanugoel.com/tags/winamp/>winamp</a>&nbsp;</span><div class=post-content><div><p>FireFly is a nice DAAP based media server that allows you to listen to your music collection anywhere using any DAAP based client like iTunes, with other players (like Winamp, Rhythmbox, VLC, etc) using plugins, or it even has its own dedicated php/flash/java based clients that can be fired up on any platform any computer giving you instant nirvana.</p><p>Many people, like me, use it on their Routers or NAS boxes to access their music anywhere without having to keep their home PC running or lugging around external drives. However, development on this gem stopped some time ago. The last stable build released (2.4.2) was good but it doesn&rsquo;t have a lot of features provided by the nightly builds in svn (subversion). And the last nightly build released (svn-1696) had a lot of broken things. It was rebuilding the database everytime, crashed around quite a bit, had a lot of security holes. So, I decided to get the latest version (trunk) of the FireFly code, as it had a lot of fixes for above issues, put in whatever was missing, and try to build it for my use.</p><p>After a day&rsquo;s worth of efforts, here it is. This latest build is the most rich in features as compared to the stable one, and is just as stable as the 2.4.2 release if not better, and also fixes all the issues shown by the svn-1696 build. The downloadable source and complete install package are attached with this post. But I&rsquo;m also listing down the steps that I took to achieve this so that if anyone wants to recompile it with their own options (e.g. I haven‚Äôt included ogg/flac support in my build), they are able to do so. You can find the steps below. Please let me know if you have any queries. Also, if you want to submit any patches, I‚Äôll be happy to incorporate them and recompile. I‚Äôm also trying to get this source and package into the unslung/optware repositories for wider distribution.</p><p><strong>Note: Although I‚Äôve compiled this for Asus WL-500W, it should work for most devices with a mipsel architecture (which includes all the Asus routers in this family). Also, the compilation process should work for most other architectures barring one or two steps. I‚Äôd be happy to help if you want to do so and face any issues.</strong></p><p>Changes and Build Steps:</p><ul><li><p>ipkg install optware-devel</p></li><li><p>ipkg install buildroot</p></li><li><p>Edit /opt/share/aclocal/audiofile.m4 and change AC_DEFUN(AM_PATH_AUDIOFILE, to AC_DEFUN([AM_PATH_AUDIOFILE],</p></li><li><p>ipkg install gettext (for some missing m4 macros, libr_rpath etc)</p></li><li><p>Comment out AC_USE_SYSTEM_EXTENSIONS in configure.in (using dnl)</p></li><li><p>aclocal -I &lt;path of mt-daapd&rsquo;s local m4 dir></p></li><li><p>run ‚Äúautoheader‚Äù to generate config.h.in</p></li><li><p>touch config.rpath (somehow this file is not provided with gettext for us)</p></li><li><p>change configure.in line 95, remove the ; at the end</p></li><li><p>remove -g flag and add -O2 in configure.in for optimization purpose</p></li><li><p>run ‚Äúautomake &ndash;add-missing‚Äù</p></li><li><p>run ‚Äúautoconf‚Äù - to generate configure</p></li><li><p>ipkg install grep (for egrep)</p></li><li><p>change /bin/sh to /opt/bin/bash in configure and install-sh</p></li><li><p>run ‚Äú./configure &ndash;enable-sqlite3 &ndash;prefix=/opt CPFLAGS=‚Äù-D_LIBC‚Äù ‚Äù (You can also use &ndash;enable-oggvorbis and/or &ndash;enableflac)</p></li><li><p>After this step, I had to make numerous changes to the source code to put in the missing functionality for database handling, removing some compilation errors, etc. You can diff the svn 1715 code with mine to see the changes.</p></li><li><p>run ‚Äúmake‚Äù</p></li><li><p>run ‚Äúmake install‚Äù</p></li></ul><p>And you are done. The modified source and compiled bianries can be downloaded from below.</p><p><em>Lost the files in a server move. Sorry :(</em></p><p>Let me know if you have any queries or face any issues.</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>¬© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>