<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>BadTokenException Android on Shantanu Vs The World</title><link>https://shantanugoel.com/tags/badtokenexception-android/</link><description>Recent content in BadTokenException Android on Shantanu Vs The World</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 08 Jul 2010 11:24:14 +0000</lastBuildDate><atom:link href="https://shantanugoel.com/tags/badtokenexception-android/index.xml" rel="self" type="application/rss+xml"/><item><title>BadTokenException Error In Android Dialog</title><link>https://shantanugoel.com/2010/07/08/badtokenexception-android-dialog-getapplicationcontext/</link><pubDate>Thu, 08 Jul 2010 11:24:14 +0000</pubDate><guid>https://shantanugoel.com/2010/07/08/badtokenexception-android-dialog-getapplicationcontext/</guid><description>&lt;p>If you are creating a custom Dialog for Android, and following the &lt;a href="http://developer.android.com/guide/topics/ui/dialogs.html">Android Developers’ Creating Dialogs&lt;/a> tutorial, then most likely you would have faced a Force Close with this exception showing up in logcat. I did too. Although I figured it out quickly, it might not be easy to find out for many, so posting it here for reference. Basically, the code given in the tutorial goes something like this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-fallback" data-lang="fallback">&lt;span style="display:flex;">&lt;span>Context mContext = getApplicationContext();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Dialog dialog = new Dialog(mContext);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dialog.setContentView(R.layout.custom_dialog);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dialog.setTitle(&amp;#34;Custom Dialog&amp;#34;);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>TextView text = (TextView) dialog.findViewById(R.id.text);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>text.setText(&amp;#34;Hello, this is a custom dialog!&amp;#34;);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ImageView image = (ImageView) dialog.findViewById(R.id.image);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>image.setImageResource(R.drawable.android);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>All looks well, but when you execute it, you will get a Force Close. The error appearing in logcat would be something like this:&lt;/p></description><content>&lt;p>If you are creating a custom Dialog for Android, and following the &lt;a href="http://developer.android.com/guide/topics/ui/dialogs.html">Android Developers’ Creating Dialogs&lt;/a> tutorial, then most likely you would have faced a Force Close with this exception showing up in logcat. I did too. Although I figured it out quickly, it might not be easy to find out for many, so posting it here for reference. Basically, the code given in the tutorial goes something like this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-fallback" data-lang="fallback">&lt;span style="display:flex;">&lt;span>Context mContext = getApplicationContext();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Dialog dialog = new Dialog(mContext);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dialog.setContentView(R.layout.custom_dialog);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dialog.setTitle(&amp;#34;Custom Dialog&amp;#34;);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>TextView text = (TextView) dialog.findViewById(R.id.text);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>text.setText(&amp;#34;Hello, this is a custom dialog!&amp;#34;);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ImageView image = (ImageView) dialog.findViewById(R.id.image);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>image.setImageResource(R.drawable.android);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>All looks well, but when you execute it, you will get a Force Close. The error appearing in logcat would be something like this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-fallback" data-lang="fallback">&lt;span style="display:flex;">&lt;span>Uncaught handler: thread main exiting due to uncaught exception
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>It isn’t apparent immediately that what is causing this error. The very first line in the code “Context mContext = getApplicationContext();” is the culprit.&lt;/p>
&lt;p>&lt;strong>Solution:&lt;/strong> Just replace “getApplicationContext()” with “this” (i.e. “Context mContext = this;” ) and it will work fine.&lt;/p>
&lt;p>&lt;strong>Explanation:&lt;/strong> As to why this is exactly an issue, I’m a bit fuzzy about it myself but this much I’m sure that the contexts that you get with getApplicationContext and this are different. On reading about this function from Android SDK help:&lt;/p>
&lt;blockquote>
&lt;p>Return the context of the single, global Application object of the current process. This generally should only be used if you need a Context whose lifecycle is separate from the current context, that is tied to the lifetime of the process rather than the current component.&lt;/p>
&lt;/blockquote>
&lt;p>I think this would mean is that getApplicationContext returns a context which is for the application itself and not the activity, while “this” would give you the context of the activity in which you are creating the dialog. I think since it is the activity which is associated with the UI (and for whom the window has been created), using the application context would have caused the crash here.&lt;/p></content></item></channel></rss>