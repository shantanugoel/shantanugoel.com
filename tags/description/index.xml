<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Description on Shantanu Vs The World</title><link>https://shantanugoel.com/tags/description/</link><description>Recent content in Description on Shantanu Vs The World</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 19 Mar 2008 03:30:00 +0000</lastBuildDate><atom:link href="https://shantanugoel.com/tags/description/index.xml" rel="self" type="application/rss+xml"/><item><title>Hack: WordPress function 'wp_list_pages' to output page description (or other custom fields) in your page lists</title><link>https://shantanugoel.com/2008/03/19/hack-wordpress-function-wp_list_pages-to-output-page-description-or-other-custom-fields-in-your-page-lists/</link><pubDate>Wed, 19 Mar 2008 03:30:00 +0000</pubDate><guid>https://shantanugoel.com/2008/03/19/hack-wordpress-function-wp_list_pages-to-output-page-description-or-other-custom-fields-in-your-page-lists/</guid><description>&lt;p>&lt;strong>Disclaimer:&lt;/strong> I&amp;rsquo;m neither a WordPress guru nor a PHP expert. This is what it is, a dirtly little hack, otherwise I&amp;rsquo;d have called it an &amp;ldquo;enhancement&amp;rdquo; &lt;img src="https://shantanugoel.com/img/uploads/smile1.gif" alt="Smile">&lt;/p>
&lt;p>Now onto the main things.&lt;/p>
&lt;p>&lt;strong>Aim:&lt;/strong> You would have used wp_list_pages (or plugins like &lt;a href="http://www.dagondesign.com/articles/list-subpages-plugin-for-wordpress/">dd-list-subpages&lt;/a>, that use it) to display a list of your pages/subpages on a particular page. e.g., I use it on my &amp;ldquo;&lt;a href="http://tech.shantanugoel.com/projects">Projects&lt;/a>&amp;rdquo; pages hierarchy to list all the relevant projects under a particular heading. Now, the thing is that wp_list_pages gives you a lot of options to display things like dates, page title, page link, etc, but that&amp;rsquo;s not enough. I need to provide a small description for each page as well, to put things into perspective. Obviously, I don&amp;rsquo;t expect the visitors to go inside each link to see what it holds in store for them.&lt;/p></description><content>&lt;p>&lt;strong>Disclaimer:&lt;/strong> I&amp;rsquo;m neither a WordPress guru nor a PHP expert. This is what it is, a dirtly little hack, otherwise I&amp;rsquo;d have called it an &amp;ldquo;enhancement&amp;rdquo; &lt;img src="https://shantanugoel.com/img/uploads/smile1.gif" alt="Smile">&lt;/p>
&lt;p>Now onto the main things.&lt;/p>
&lt;p>&lt;strong>Aim:&lt;/strong> You would have used wp_list_pages (or plugins like &lt;a href="http://www.dagondesign.com/articles/list-subpages-plugin-for-wordpress/">dd-list-subpages&lt;/a>, that use it) to display a list of your pages/subpages on a particular page. e.g., I use it on my &amp;ldquo;&lt;a href="http://tech.shantanugoel.com/projects">Projects&lt;/a>&amp;rdquo; pages hierarchy to list all the relevant projects under a particular heading. Now, the thing is that wp_list_pages gives you a lot of options to display things like dates, page title, page link, etc, but that&amp;rsquo;s not enough. I need to provide a small description for each page as well, to put things into perspective. Obviously, I don&amp;rsquo;t expect the visitors to go inside each link to see what it holds in store for them.&lt;/p>
&lt;p>&lt;strong>The Hack:&lt;/strong> What you need to do is locate a file called &amp;ldquo;classes.php&amp;rdquo; in your wordpress installation. It is usually located at &lt;code>&amp;lt;WordPress Base&amp;gt;/wp-includes&lt;/code>.&lt;/p>
&lt;p>Now, open the file and find a function called &amp;ldquo;start_el&amp;rdquo;. This is a function in the &amp;ldquo;Walker&amp;rdquo; class, which is used in WordPress to parse tree-like structures. Here, it used by wp_list_pages to list out all the pages. Now, at the very end of this function (just after the closing brace of if ( !empty($show_date) ) { ), place the following piece of code:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>$description &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">get_post_meta&lt;/span>($page&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">ID&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;description&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">true&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> ($page&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">ID&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> $current_page)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $output &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;lt;br&amp;gt;&amp;lt;/br&amp;gt; &amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>$description)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $description &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">strip_tags&lt;/span>(&lt;span style="color:#a6e22e">substr&lt;/span>($page&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">post_content&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">250&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $output &lt;span style="color:#f92672">.=&lt;/span> $description;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>What this code does is:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Look for a custom field called &amp;ldquo;description&amp;rdquo; in your pages. If present, it will show what you wrote there after each of your page in the list generated by wp_list_pages. (To add a custom field to your page, look at the very bottom of your &amp;ldquo;write&amp;rdquo; page or &amp;ldquo;manage&amp;rdquo; page in the WordPress dashboard.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>If the &amp;ldquo;description&amp;rdquo; field is not present (obviously you might not like to go back and add a custom field to all your pages), it takes the first 250 characters of your page&amp;rsquo;s content and displays that.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>The Hack Is Not Finished Yet:&lt;/strong> There is just one little thing left to do. As I mentioned, this function is used other times as well (e.g. making your navigation menu). So, you don&amp;rsquo;t want the description to be appearing always, otherwise it will wreak havoc on your site&amp;rsquo;s layout. So, there is again a dirty little trick to prevent this.&lt;/p>
&lt;p>At the place where you are calling wp_list_pages, modify the call to include the following code before and after the call:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">update_option&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;my_wp_list_pages_option&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$content &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#a6e22e">wp_list_pages&lt;/span>($your_wp_list_pages_options);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">update_option&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;my_wp_list_pages_option&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>And, modify the previously listed code as well to look like:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>$my_wp_list_pages_option &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">get_option&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;my_wp_list_pages_option&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> ($my_wp_list_pages_option &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $description &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">get_post_meta&lt;/span>($page&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">ID&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;description&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">true&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> ($page&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">ID&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> $current_page)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $output &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;lt;br&amp;gt;&amp;lt;/br&amp;gt; &amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>$description)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $description &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">strip_tags&lt;/span>(&lt;span style="color:#a6e22e">substr&lt;/span>($page&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">post_content&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">250&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $output &lt;span style="color:#f92672">.=&lt;/span> $description;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>What this does now is that it adds an option/variable to WordPress database, which you set to 1 before calling wp_list_pages to tell your code that now its time to display the description, and then restore its state to 0, to prevent the description from being displayed for any other wp_list_pages call.&lt;/p>
&lt;p>For your reference, I&amp;rsquo;m attaching my copy of classes.php here.&lt;strong>&lt;a href="http://tech.shantanugoel.com/uploads/classes.php.zip">File Attachment: classes.php.zip (6 KB)&lt;/a>&lt;/strong>.&lt;/p>
&lt;p>For an example of how it finally looks like, take a look at my &amp;ldquo;&lt;a href="http://tech.shantanugoel.com/projects">Project&lt;/a>&amp;rdquo; page.&lt;/p>
&lt;p>&lt;strong>Now It Is Finished:&lt;/strong> Yes, am not lying. It&amp;rsquo;s done. All your &amp;ldquo;Thank You&amp;rsquo;s&amp;rdquo; are accepted, and so are your flames, if any &lt;img src="https://shantanugoel.com/img/uploads/smile1.gif" alt="Smile">.&lt;/p></content></item></channel></rss>