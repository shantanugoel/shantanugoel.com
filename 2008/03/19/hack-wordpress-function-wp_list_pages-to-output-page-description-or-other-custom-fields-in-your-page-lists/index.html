<!doctype html><html lang=en><head><title>Hack: WordPress function 'wp_list_pages' to output page description (or other custom fields) in your page lists :: Shantanu Vs The World</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Disclaimer: I&rsquo;m neither a WordPress guru nor a PHP expert. This is what it is, a dirtly little hack, otherwise I&rsquo;d have called it an &ldquo;enhancement&rdquo; Now onto the main things.
Aim: You would have used wp_list_pages (or plugins like dd-list-subpages, that use it) to display a list of your pages/subpages on a particular page. e.g., I use it on my &ldquo;Projects&rdquo; pages hierarchy to list all the relevant projects under a particular heading. Now, the thing is that wp_list_pages gives you a lot of options to display things like dates, page title, page link, etc, but that&rsquo;s not enough. I need to provide a small description for each page as well, to put things into perspective. Obviously, I don&rsquo;t expect the visitors to go inside each link to see what it holds in store for them.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://shantanugoel.com/2008/03/19/hack-wordpress-function-wp_list_pages-to-output-page-description-or-other-custom-fields-in-your-page-lists/><link rel=stylesheet href=https://shantanugoel.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css><link rel=stylesheet href=https://shantanugoel.com/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css><link rel=stylesheet href=https://shantanugoel.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css><link rel=stylesheet href=https://shantanugoel.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css><link rel=stylesheet href=https://shantanugoel.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://shantanugoel.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css><link rel=stylesheet href=https://shantanugoel.com/css/main.min.fe8dc560fccb53a458b0db19ccb7b265764ac46b68596b7e099c6793054dd457.css><link rel=stylesheet href=https://shantanugoel.com/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css><link rel=stylesheet href=https://shantanugoel.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css><link rel=stylesheet href=https://shantanugoel.com/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css><link rel=stylesheet href=https://shantanugoel.com/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css><link rel=stylesheet href=https://shantanugoel.com/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css><link rel=stylesheet href=https://shantanugoel.com/css/terminal.min.dd0bf9c7cacb24c1b0184f52f1869b274e06689557468cc7030ccf632328eb97.css><link rel=stylesheet href=https://shantanugoel.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel="shortcut icon" href=https://shantanugoel.com/favicon.png><link rel=apple-touch-icon href=https://shantanugoel.com/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Hack: WordPress function 'wp_list_pages' to output page description (or other custom fields) in your page lists"><meta property="og:description" content="Disclaimer: I&rsquo;m neither a WordPress guru nor a PHP expert. This is what it is, a dirtly little hack, otherwise I&rsquo;d have called it an &ldquo;enhancement&rdquo; Now onto the main things.
Aim: You would have used wp_list_pages (or plugins like dd-list-subpages, that use it) to display a list of your pages/subpages on a particular page. e.g., I use it on my &ldquo;Projects&rdquo; pages hierarchy to list all the relevant projects under a particular heading. Now, the thing is that wp_list_pages gives you a lot of options to display things like dates, page title, page link, etc, but that&rsquo;s not enough. I need to provide a small description for each page as well, to put things into perspective. Obviously, I don&rsquo;t expect the visitors to go inside each link to see what it holds in store for them.
"><meta property="og:url" content="https://shantanugoel.com/2008/03/19/hack-wordpress-function-wp_list_pages-to-output-page-description-or-other-custom-fields-in-your-page-lists/"><meta property="og:site_name" content="Shantanu Vs The World"><meta property="og:image" content="https://shantanugoel.com/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Code"><meta property="article:published_time" content="2008-03-19 03:30:00 +0000 UTC"></head><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Shantanu vs The World</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;‚ñæ</li><li><ul class=menu__dropdown><li><a href=https://github.com/shantanugoel/>üíª</a></li><li><a href=https://x.com/shantanugoel/>üê§</a></li><li><a href=/>/blog</a></li><li><a href=/notes>/notes</a></li><li><a href=/about>/about</a></li><li><a href=/archives>/archives</a></li><li><a href=/categories>/categories</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=https://github.com/shantanugoel/>üíª</a></li><li><a href=https://x.com/shantanugoel/>üê§</a></li><li><a href=/>/blog</a></li><li><a href=/notes>/notes</a></li><li><a href=/about>/about</a></li><li><a href=/archives>/archives</a></li><li><a href=/categories>/categories</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://shantanugoel.com/2008/03/19/hack-wordpress-function-wp_list_pages-to-output-page-description-or-other-custom-fields-in-your-page-lists/>Hack: WordPress function &lsquo;wp_list_pages&rsquo; to output page description (or other custom fields) in your page lists</a></h1><div class=post-meta><time class=post-date>2008-03-19</time><span class=post-author>Shantanu Goel</span></div><span class=post-tags>#<a href=https://shantanugoel.com/tags/custom-fields/>custom fields</a>&nbsp;
#<a href=https://shantanugoel.com/tags/description/>description</a>&nbsp;
#<a href=https://shantanugoel.com/tags/hack/>Hack</a>&nbsp;
#<a href=https://shantanugoel.com/tags/list-of-pages/>list of pages</a>&nbsp;
#<a href=https://shantanugoel.com/tags/pages/>pages</a>&nbsp;
#<a href=https://shantanugoel.com/tags/php/>PHP</a>&nbsp;
#<a href=https://shantanugoel.com/tags/start_el/>start_el</a>&nbsp;
#<a href=https://shantanugoel.com/tags/subpages/>subpages</a>&nbsp;
#<a href=https://shantanugoel.com/tags/walker/>Walker</a>&nbsp;
#<a href=https://shantanugoel.com/tags/wordpress/>wordpress</a>&nbsp;
#<a href=https://shantanugoel.com/tags/wp_list_pages/>wp_list_pages</a>&nbsp;</span><div class=post-content><div><p><strong>Disclaimer:</strong> I&rsquo;m neither a WordPress guru nor a PHP expert. This is what it is, a dirtly little hack, otherwise I&rsquo;d have called it an &ldquo;enhancement&rdquo; <img src=/img/uploads/smile1.gif alt=Smile></p><p>Now onto the main things.</p><p><strong>Aim:</strong> You would have used wp_list_pages (or plugins like <a href=http://www.dagondesign.com/articles/list-subpages-plugin-for-wordpress/>dd-list-subpages</a>, that use it) to display a list of your pages/subpages on a particular page. e.g., I use it on my &ldquo;<a href=http://tech.shantanugoel.com/projects>Projects</a>&rdquo; pages hierarchy to list all the relevant projects under a particular heading. Now, the thing is that wp_list_pages gives you a lot of options to display things like dates, page title, page link, etc, but that&rsquo;s not enough. I need to provide a small description for each page as well, to put things into perspective. Obviously, I don&rsquo;t expect the visitors to go inside each link to see what it holds in store for them.</p><p><strong>The Hack:</strong> What you need to do is locate a file called &ldquo;classes.php&rdquo; in your wordpress installation. It is usually located at <code>&lt;WordPress Base>/wp-includes</code>.</p><p>Now, open the file and find a function called &ldquo;start_el&rdquo;. This is a function in the &ldquo;Walker&rdquo; class, which is used in WordPress to parse tree-like structures. Here, it used by wp_list_pages to list out all the pages. Now, at the very end of this function (just after the closing brace of if ( !empty($show_date) ) { ), place the following piece of code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$description <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_post_meta</span>($page<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>ID</span>, <span style=color:#e6db74>&#34;description&#34;</span>, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($page<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>ID</span> <span style=color:#f92672>!=</span> $current_page)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $output <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#34;&lt;br&gt;&lt;/br&gt;    &#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$description)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $description <span style=color:#f92672>=</span> <span style=color:#a6e22e>strip_tags</span>(<span style=color:#a6e22e>substr</span>($page<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>post_content</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>250</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    $output <span style=color:#f92672>.=</span> $description;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>What this code does is:</p><ol><li><p>Look for a custom field called &ldquo;description&rdquo; in your pages. If present, it will show what you wrote there after each of your page in the list generated by wp_list_pages. (To add a custom field to your page, look at the very bottom of your &ldquo;write&rdquo; page or &ldquo;manage&rdquo; page in the WordPress dashboard.</p></li><li><p>If the &ldquo;description&rdquo; field is not present (obviously you might not like to go back and add a custom field to all your pages), it takes the first 250 characters of your page&rsquo;s content and displays that.</p></li></ol><p><strong>The Hack Is Not Finished Yet:</strong> There is just one little thing left to do. As I mentioned, this function is used other times as well (e.g. making your navigation menu). So, you don&rsquo;t want the description to be appearing always, otherwise it will wreak havoc on your site&rsquo;s layout. So, there is again a dirty little trick to prevent this.</p><p>At the place where you are calling wp_list_pages, modify the call to include the following code before and after the call:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>update_option</span>(<span style=color:#e6db74>&#39;my_wp_list_pages_option&#39;</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>$content <span style=color:#f92672>.=</span> <span style=color:#a6e22e>wp_list_pages</span>($your_wp_list_pages_options);
</span></span><span style=display:flex><span><span style=color:#a6e22e>update_option</span>(<span style=color:#e6db74>&#39;my_wp_list_pages_option&#39;</span>, <span style=color:#ae81ff>0</span>);
</span></span></code></pre></div><p>And, modify the previously listed code as well to look like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$my_wp_list_pages_option <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_option</span>(<span style=color:#e6db74>&#39;my_wp_list_pages_option&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($my_wp_list_pages_option <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $description <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_post_meta</span>($page<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>ID</span>, <span style=color:#e6db74>&#34;description&#34;</span>, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($page<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>ID</span> <span style=color:#f92672>!=</span> $current_page)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $output <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#34;&lt;br&gt;&lt;/br&gt;    &#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$description)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            $description <span style=color:#f92672>=</span> <span style=color:#a6e22e>strip_tags</span>(<span style=color:#a6e22e>substr</span>($page<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>post_content</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>250</span>));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $output <span style=color:#f92672>.=</span> $description;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>What this does now is that it adds an option/variable to WordPress database, which you set to 1 before calling wp_list_pages to tell your code that now its time to display the description, and then restore its state to 0, to prevent the description from being displayed for any other wp_list_pages call.</p><p>For your reference, I&rsquo;m attaching my copy of classes.php here.<strong><a href=http://tech.shantanugoel.com/uploads/classes.php.zip>File Attachment: classes.php.zip (6 KB)</a></strong>.</p><p>For an example of how it finally looks like, take a look at my &ldquo;<a href=http://tech.shantanugoel.com/projects>Project</a>&rdquo; page.</p><p><strong>Now It Is Finished:</strong> Yes, am not lying. It&rsquo;s done. All your &ldquo;Thank You&rsquo;s&rdquo; are accepted, and so are your flames, if any <img src=/img/uploads/smile1.gif alt=Smile>.</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>¬© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>