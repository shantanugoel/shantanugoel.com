<!doctype html><html lang=en><head><title>TIP: Automating Website Backups :: Shantanu Vs The World</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="What can go wrong with your wonderfully running website / blog? Everything..
Your online abode is so difficult to keep secured. It can get hacked, you may install something wrong, a wrong configuration can wreak havoc, the server hard disk might crash, natural calamities, and what not. Your best option to secure yourself against all this is summarized in just one word ‚ÄúBACKUP‚Äù.
Now, a backup involves two most important things: ‚ÄúDatabase Backup‚Äù and ‚ÄúFiles Backup‚Äù. Most webhosts give you the options to back these up for you but with a few catches:
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://shantanugoel.com/2008/02/17/tip-automating-website-backups/><script async src="https://www.googletagmanager.com/gtag/js?id=G-5CKCTSFXW8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5CKCTSFXW8")}</script><link rel=stylesheet href=https://shantanugoel.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css><link rel=stylesheet href=https://shantanugoel.com/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css><link rel=stylesheet href=https://shantanugoel.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css><link rel=stylesheet href=https://shantanugoel.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css><link rel=stylesheet href=https://shantanugoel.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://shantanugoel.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css><link rel=stylesheet href=https://shantanugoel.com/css/main.min.fe8dc560fccb53a458b0db19ccb7b265764ac46b68596b7e099c6793054dd457.css><link rel=stylesheet href=https://shantanugoel.com/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css><link rel=stylesheet href=https://shantanugoel.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css><link rel=stylesheet href=https://shantanugoel.com/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css><link rel=stylesheet href=https://shantanugoel.com/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css><link rel=stylesheet href=https://shantanugoel.com/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css><link rel=stylesheet href=https://shantanugoel.com/css/terminal.min.dd0bf9c7cacb24c1b0184f52f1869b274e06689557468cc7030ccf632328eb97.css><link rel=stylesheet href=https://shantanugoel.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel="shortcut icon" href=https://shantanugoel.com/favicon.png><link rel=apple-touch-icon href=https://shantanugoel.com/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="TIP: Automating Website Backups"><meta property="og:description" content="What can go wrong with your wonderfully running website / blog? Everything..
Your online abode is so difficult to keep secured. It can get hacked, you may install something wrong, a wrong configuration can wreak havoc, the server hard disk might crash, natural calamities, and what not. Your best option to secure yourself against all this is summarized in just one word ‚ÄúBACKUP‚Äù.
Now, a backup involves two most important things: ‚ÄúDatabase Backup‚Äù and ‚ÄúFiles Backup‚Äù. Most webhosts give you the options to back these up for you but with a few catches:
"><meta property="og:url" content="https://shantanugoel.com/2008/02/17/tip-automating-website-backups/"><meta property="og:site_name" content="Shantanu Vs The World"><meta property="og:image" content="https://shantanugoel.com/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Tinker"><meta property="article:published_time" content="2008-02-17 09:19:50 +0000 UTC"></head><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Shantanu vs The World</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;‚ñæ</li><li><ul class=menu__dropdown><li><a href=https://github.com/shantanugoel/>üíª</a></li><li><a href=https://x.com/shantanugoel/>üê§</a></li><li><a href=/>/blog</a></li><li><a href=/notes>/notes</a></li><li><a href=/about>/about</a></li><li><a href=/archives>/archives</a></li><li><a href=/categories>/categories</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=https://github.com/shantanugoel/>üíª</a></li><li><a href=https://x.com/shantanugoel/>üê§</a></li><li><a href=/>/blog</a></li><li><a href=/notes>/notes</a></li><li><a href=/about>/about</a></li><li><a href=/archives>/archives</a></li><li><a href=/categories>/categories</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://shantanugoel.com/2008/02/17/tip-automating-website-backups/>TIP: Automating Website Backups</a></h1><div class=post-meta><time class=post-date>2008-02-17</time><span class=post-author>Shantanu Goel</span></div><span class=post-tags>#<a href=https://shantanugoel.com/tags/automate-site-backup/>automate site backup</a>&nbsp;
#<a href=https://shantanugoel.com/tags/automate-website-backup/>automate website backup</a>&nbsp;
#<a href=https://shantanugoel.com/tags/automated-backup/>automated backup</a>&nbsp;
#<a href=https://shantanugoel.com/tags/automatically-e-mail-site-backup/>automatically e-mail site backup</a>&nbsp;
#<a href=https://shantanugoel.com/tags/backup/>backup</a>&nbsp;
#<a href=https://shantanugoel.com/tags/cron/>cron</a>&nbsp;
#<a href=https://shantanugoel.com/tags/crontab/>crontab</a>&nbsp;
#<a href=https://shantanugoel.com/tags/site-backup/>site backup</a>&nbsp;
#<a href=https://shantanugoel.com/tags/tar/>tar</a>&nbsp;
#<a href=https://shantanugoel.com/tags/webhosting/>Webhosting</a>&nbsp;
#<a href=https://shantanugoel.com/tags/webhosting-tip/>webhosting tip</a>&nbsp;
#<a href=https://shantanugoel.com/tags/website-backup/>website backup</a>&nbsp;</span><div class=post-content><div><p>What can go wrong with your wonderfully running website / blog? Everything..</p><p>Your online abode is so difficult to keep secured. It can get hacked, you may install something wrong, a wrong configuration can wreak havoc, the server hard disk might crash, natural calamities, and what not. Your best option to secure yourself against all this is summarized in just one word ‚ÄúBACKUP‚Äù.</p><p>Now, a backup involves two most important things: ‚ÄúDatabase Backup‚Äù and ‚ÄúFiles Backup‚Äù. Most webhosts give you the options to back these up for you but with a few catches:</p><ul><li><p>You can backup but only through your control panel manually. No automation/scheduling of backups.</p></li><li><p>Automated Backing up is not free</p></li><li><p>Automated Backing up is free but restoring is not as they give you the backed up data only on request.</p></li></ul><p>There are many plugins available for most CMS and blogging sw for backing up databases. But what about the files? Especially if you have more than one sites on one hosting account. Well, here I‚Äôll tell you how to automate file backups in three simple steps.</p><p>Note: This guide is only for linux based hosts. But you can follow a similar approach for windows based hosting as well.</p><p>Step 1) Backup through command line.</p><p>You can use ‚Äútar‚Äù for this. With tar, you can create compressed archives quickly for a complete directory tree.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>tar cvzf ~/backups/backup_`date +%w`.tgz ~/public_html
</span></span></code></pre></div><p>Explanation:</p><ul><li><p>tar is the name of the command</p></li><li><p>c => compress v=> verbose z=>gzip for compression</p></li><li><p><del>/backups => backup directory where ur backups will be stored (</del> is shortcut for your home directory). It is generally a good practice to store your backups in a directory not directly accessible through http, i.e., outside your public_html directory.</p></li><li><p>backup_<code>date +%w</code>.tgz => forms the name of the backup file in the form <code>backup_&lt;dayofweek>.tgz</code>. This will form a circular buffer kind of scenario where backups more than 1 week later will automatically be overwritten by latest ones to avoid using up all your webspace. You can modify this according to your need and available webspace by taking a look at man page of ‚Äúdate‚Äù command. (Run ‚Äúman date‚Äù on command line)</p></li><li><p>~/public_html => is the directory you want to backup. Most probably your website will be located in this directory. If not sure, then check with your webhost.</p></li></ul><p>Step 2) Mailing the backup to yourself through command line. (The server might develop some problem, hard disk might crash or your backups on server might be lost, so this is a good option to have)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mutt <span style=color:#f92672>-</span>s <span style=color:#e6db74>&#34;Backup `date`&#34;</span> <span style=color:#f92672>-</span>a <span style=color:#f92672>~/</span>backups<span style=color:#f92672>/</span>backup_<span style=color:#f92672>`</span><span style=color:#66d9ef>date</span> <span style=color:#f92672>+%</span>w<span style=color:#f92672>`</span>.tgz myuserid<span style=color:#f92672>@</span>mymail.com
</span></span></code></pre></div><p>Explanation:</p><ul><li><p>mutt => mailing user agent that sends the mail (You can use others, but I prefer mutt)</p></li><li><p>-s &ldquo;Backup <code>date</code>&rdquo; => -s option is to specify the subject of the mail on command line. This line will specify the backup date as subject.</p></li><li><p>-a ~/backups/backup_<code>date +%w</code>.tgz => -a option specifies the file to be attached.</p></li><li><p><a href=mailto:myuserid@mymail.com>myuserid@mymail.com</a> => Specify the mail id t which the email has to be sent</p></li><li><p>&lt;/dev/null => The body of the email is empty. If you want some text to be here, you can form a file, say ‚Äúemail.txt‚Äù and write the contents in it and replace the above part with ‚Äú&lt;email.txt‚Äù</p></li></ul><p>Step 3) Final Step. Automating it all. What you need to do is add the above commands into a script and then find a way to make it run automatically.</p><p>The script looks like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    tar cvzf ~/backups/backup_<span style=color:#e6db74>`</span>date +%w<span style=color:#e6db74>`</span>.tgz ~/public_html
</span></span><span style=display:flex><span>    mutt -s <span style=color:#e6db74>&#34;Backup `date`&#34;</span> -a ~/backups/backup_<span style=color:#e6db74>`</span>date +%w<span style=color:#e6db74>`</span>.tgz myuserid@mymail.com
</span></span></code></pre></div><p>Save it as ‚Äúbackup.sh‚Äù and make it executable by running ‚Äúchmod +x backup.sh‚Äù. We‚Äôll assume that you save it in ~/backups directory. You can store it anywhere, just remember it.</p><p>Now, you need to tell the server to run it automatically at a specified time. We‚Äôll use ‚Äúcron‚Äù for this. (If you are not comfortable with command line, then login to your website control panel, and look for an option called cron, where you can make the schedule graphically) Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>crontab -e
</span></span></code></pre></div><p>This will open a file with your scheduled tasks info. Make sure that you don‚Äôt touch any of the existing lines. Add the following line at the end.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>MAILTO=&#34;myusername&#34;
</span></span><span style=display:flex><span>00 22 * * * ~/backups/backup.sh
</span></span></code></pre></div><p>The first line will make sure that the output of the script, any errors etc, are sent to the your local mail account, that you can check for debugging purposes.</p><p>The second line is of the format ‚Äú# m h dom mon dow command‚Äù
m=> minute of the hour
h=&#187; hour of the day
dom=> Day of month
mon=> month of year
dow=> day of week
command=> command that you want to run
So, the command mentioned above will run the command every day at 10:00 PM GMT. You can modify the line according to your needs.</p><p>That‚Äôs it. You are done. Just wait for the specified time, and then check your mailbox for the backup file. Let me know if you face any problems, have any issues, or want to ask any questions about cuztomizing it for yourself.</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>¬© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>